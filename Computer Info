if (Test-Path $outputFile) {
    Remove-Item $outputFile -Force
}

try {
    $os  = Get-CimInstance Win32_OperatingSystem
    $cpu = Get-CimInstance Win32_Processor
    $ram = [math]::Round($os.TotalVisibleMemorySize / 1MB, 2)
    $bios = Get-CimInstance Win32_BIOS
    $cs = Get-CimInstance Win32_ComputerSystem
    $username = $env:USERNAME

    $diskDrives = Get-CimInstance Win32_DiskDrive
    # ØªØ¹Ø¯ÙŠÙ„ Ù„Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ ÙƒØ±ÙˆØª Ø§Ù„Ø´Ø¨ÙƒØ©ØŒ Ø­ØªÙ‰ Ø§Ù„ØºÙŠØ± Ù…ÙØ¹Ù„Ø©
    $netAdapters = Get-NetAdapter
    $netIPs = Get-NetIPAddress -AddressFamily IPv4 | Where-Object { $_.IPAddress -notmatch '^169\.254|^127\.' }

    $results = @()
    $first = $true

    # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ù‚Ø±Ø§Øµ
    foreach ($disk in $diskDrives) {
        $model = $disk.Model
        $sizeGB = [math]::Round($disk.Size / 1GB, 2)
        $type = if ($model -match "SSD") { "SSD" }
                elseif ($model -match "NVMe" -or $model -match "M.2") { "NVMe/M.2" }
                else { "HDD" }

        $serial = ($disk | Get-CimAssociatedInstance -ResultClassName Win32_PhysicalMedia).SerialNumber

        $results += [PSCustomObject]@{
            ComputerName   = if ($first) { $computerName } else { "-" }
            Username       = if ($first) { $username } else { "-" }
            OS             = if ($first) { $os.Caption } else { "-" }
            OSVersion      = if ($first) { $os.Version } else { "-" }
            CPU            = if ($first) { $cpu.Name } else { "-" }
            RAM_GB         = if ($first) { $ram } else { "-" }
            Network_Name   = "-"
            MAC_Address    = "-"
            IP_Address     = "-"
            Disk_Model     = $model
            Disk_Type      = $type
            Disk_Size_GB   = $sizeGB
            Disk_Serial    = $serial
            Serial_Number  = if ($first) { $bios.SerialNumber } else { "-" }
            Manufacturer   = if ($first) { $cs.Manufacturer } else { "-" }
            Model          = if ($first) { $cs.Model } else { "-" }
        }

        $first = $false
    }

    # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ©
    foreach ($adapter in $netAdapters) {
        $adapterName = $adapter.Name
        $macAddress = $adapter.MacAddress

        $ips = $netIPs | Where-Object { $_.InterfaceAlias -eq $adapterName }
        if ($ips.Count -eq 0) {
            $results += [PSCustomObject]@{
                ComputerName   = "-"
                Username       = "-"
                OS             = "-"
                OSVersion      = "-"
                CPU            = "-"
                RAM_GB         = "-"
                Network_Name   = $adapterName
                MAC_Address    = $macAddress
                IP_Address     = "N/A"
                Disk_Model     = "-"
                Disk_Type      = "-"
                Disk_Size_GB   = "-"
                Disk_Serial    = "-"
                Serial_Number  = "-"
                Manufacturer   = "-"
                Model          = "-"
            }
        } else {
            foreach ($ipObj in $ips) {
                $results += [PSCustomObject]@{
                    ComputerName   = "-"
                    Username       = "-"
                    OS             = "-"
                    OSVersion      = "-"
                    CPU            = "-"
                    RAM_GB         = "-"
                    Network_Name   = $adapterName
                    MAC_Address    = $macAddress
                    IP_Address     = $ipObj.IPAddress
                    Disk_Model     = "-"
                    Disk_Type      = "-"
                    Disk_Size_GB   = "-"
                    Disk_Serial    = "-"
                    Serial_Number  = "-"
                    Manufacturer   = "-"
                    Model          = "-"
                }
            }
        }
    }

    # ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù…Ù„Ù CSV
    $results | Export-Csv -Path $outputFile -NoTypeInformation -Encoding UTF8
    Write-Host "`nâœ… ØªÙ… Ø­ÙØ¸ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¬Ù‡Ø§Ø² ÙÙŠ: $outputFile" -ForegroundColor Green

    Write-Host "ğŸ“§ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¥Ù„Ù‰: $to" -ForegroundColor Cyan
}
catch {
    Write-Warning "âŒ Ø­ØµÙ„ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªÙ†ÙÙŠØ° Ø§Ù„Ø³ÙƒØ±Ø¨Øª: $_"
}
